<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–†–µ–∫–ª–∞–º–∞ ‚Äî –î–µ–∫–∞–±—Ä—å 2025</title>
    <style>
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #1a1a2e;
            color: #eee;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        
        h1 {
            text-align: center;
            color: #fff;
            margin-bottom: 10px;
        }
        
        .stats {
            text-align: center;
            color: #888;
            margin-bottom: 20px;
            font-size: 14px;
        }
        
        .stats span {
            color: #4ade80;
            font-weight: bold;
        }
        
        .sync-status {
            text-align: center;
            font-size: 12px;
            margin-bottom: 15px;
            padding: 5px 10px;
            border-radius: 5px;
            background: #0f172a;
        }
        
        .sync-status.syncing {
            color: #f59e0b;
        }
        
        .sync-status.synced {
            color: #4ade80;
        }
        
        .sync-status.error {
            color: #ef4444;
        }
        
        .filters {
            background: #0f172a;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .filters-row {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .filters-row:last-child {
            margin-bottom: 0;
        }
        
        .filters label {
            font-size: 12px;
            color: #888;
            margin-right: 5px;
        }
        
        .filters select {
            background: #1e293b;
            border: 1px solid #334155;
            color: #fff;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 13px;
            cursor: pointer;
        }
        
        .filters select:focus {
            outline: none;
            border-color: #4ade80;
        }
        
        .contact {
            margin: 8px 0;
            background: #16213e;
            border-radius: 10px;
            transition: all 0.2s;
            overflow: hidden;
        }
        
        .move-buttons {
            display: flex;
            flex-direction: column;
            margin-right: 10px;
        }
        
        .btn-move {
            background: #334155;
            color: #888;
            border: none;
            padding: 2px 6px;
            font-size: 10px;
            cursor: pointer;
            border-radius: 3px;
            margin: 1px 0;
        }
        
        .btn-move:hover {
            background: #4ade80;
            color: #000;
        }
        
        .contact.hidden {
            display: none;
        }
        
        .contact:hover {
            background: #1f3460;
        }
        
        .contact.done {
            background: #064e3b;
            border-left: 4px solid #4ade80;
        }
        
        .contact-header {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            cursor: pointer;
        }
        
        .checkbox {
            width: 24px;
            height: 24px;
            margin-right: 15px;
            cursor: pointer;
            accent-color: #4ade80;
            flex-shrink: 0;
        }
        
        .number {
            color: #666;
            margin-right: 12px;
            font-size: 12px;
            min-width: 25px;
        }
        
        .contact-name-input {
            color: #60a5fa;
            font-size: 16px;
            font-weight: bold;
            flex-grow: 1;
            background: transparent;
            border: 1px solid transparent;
            border-radius: 4px;
            padding: 4px 8px;
            margin: -4px 0;
            min-width: 100px;
        }
        
        .contact-name-input:hover {
            border-color: #334155;
        }
        
        .contact-name-input:focus {
            outline: none;
            border-color: #4ade80;
            background: #0f172a;
        }
        
        .contact-status {
            font-size: 11px;
            margin-right: 10px;
            padding: 3px 8px;
            border-radius: 4px;
            background: #334155;
            white-space: nowrap;
        }
        
        .btn-open-single {
            background: #3b82f6;
            color: white;
            padding: 6px 12px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            margin-left: 10px;
        }
        
        .btn-open-single:hover {
            background: #2563eb;
        }
        
        .btn-delete {
            background: #ef4444;
            color: white;
            padding: 6px 10px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 11px;
            margin-left: 5px;
        }
        
        .btn-delete:hover {
            background: #dc2626;
        }
        
        .expand-icon {
            margin-left: 10px;
            font-size: 12px;
            color: #666;
            transition: transform 0.2s;
        }
        
        .contact.expanded .expand-icon {
            transform: rotate(180deg);
        }
        
        .contact-fields {
            display: none;
            padding: 0 15px 15px 15px;
            border-top: 1px solid #334155;
        }
        
        .contact.expanded .contact-fields {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            padding-top: 15px;
        }
        
        .field {
            display: flex;
            flex-direction: column;
        }
        
        .field.full-width {
            grid-column: 1 / -1;
        }
        
        .field label {
            font-size: 11px;
            color: #888;
            margin-bottom: 3px;
        }
        
        .field input, .field select, .field textarea {
            background: #0f172a;
            border: 1px solid #334155;
            color: #fff;
            padding: 8px 10px;
            border-radius: 6px;
            font-size: 13px;
            font-family: inherit;
        }
        
        .field textarea {
            resize: vertical;
            min-height: 80px;
        }
        
        .field input:focus, .field select:focus, .field textarea:focus {
            outline: none;
            border-color: #4ade80;
        }
        
        .field select {
            cursor: pointer;
        }
        
        .controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        button {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }
        
        .btn-reset {
            background: #ef4444;
            color: white;
        }
        
        .btn-reset:hover {
            background: #dc2626;
        }
        
        .btn-save {
            background: #4ade80;
            color: #000;
        }
        
        .btn-save:hover {
            background: #22c55e;
        }
        
        .btn-import {
            background: #a855f7;
            color: white;
        }
        
        .btn-import:hover {
            background: #9333ea;
        }
        
        .btn-open {
            background: #3b82f6;
            color: white;
        }
        
        .btn-open:hover {
            background: #2563eb;
        }
        
        .btn-toggle {
            background: #64748b;
            color: white;
        }
        
        .btn-toggle:hover {
            background: #475569;
        }
        
        .btn-add {
            background: #10b981;
            color: white;
            width: 100%;
            margin-top: 20px;
            padding: 15px;
            font-size: 16px;
        }
        
        .btn-add:hover {
            background: #059669;
        }
        
        .btn-sync {
            background: #06b6d4;
            color: white;
        }
        
        .btn-sync:hover {
            background: #0891b2;
        }
        
        .progress {
            background: #333;
            border-radius: 10px;
            height: 20px;
            margin-bottom: 20px;
            overflow: hidden;
        }
        
        .progress-bar {
            background: linear-gradient(90deg, #4ade80, #22c55e);
            height: 100%;
            width: 0%;
            transition: width 0.3s;
        }

        @media (max-width: 600px) {
            .contact.expanded .contact-fields {
                grid-template-columns: 1fr;
            }
            .controls {
                flex-direction: column;
            }
            button {
                width: 100%;
            }
            .contact-status {
                display: none;
            }
            .filters-row {
                flex-direction: column;
                align-items: stretch;
            }
            .filters select {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <h1>üìã –†–µ–∫–ª–∞–º–∞ ‚Äî –î–µ–∫–∞–±—Ä—å 2025</h1>
    
    <div class="sync-status" id="sync-status">‚è≥ –ó–∞–≥—Ä—É–∑–∫–∞...</div>
    
    <div class="stats">
        –ì–æ—Ç–æ–≤–æ: <span id="done-count">0</span> / <span id="total-count">82</span> | –ü–æ–∫–∞–∑–∞–Ω–æ: <span id="shown-count">82</span>
    </div>
    
    <div class="progress">
        <div class="progress-bar" id="progress-bar"></div>
    </div>
    
    <div class="filters">
        <div class="filters-row">
            <label>üîç –ü–æ–∏—Å–∫:</label>
            <input type="text" id="search-input" placeholder="–ü–æ–∏—Å–∫ –ø–æ –≤—Å–µ–º –ø–æ–ª—è–º..." oninput="applyFilters()" style="flex-grow: 1; background: #1e293b; border: 1px solid #334155; color: #fff; padding: 8px 12px; border-radius: 6px; font-size: 13px;">
        </div>
        <div class="filters-row">
            <label>–§–∏–ª—å—Ç—Ä –ø–æ —Å—Ç–∞—Ç—É—Å—É:</label>
            <select id="filter-status" onchange="applyFilters()">
                <option value="">–í—Å–µ</option>
                <option value="no-status">–ë–µ–∑ —Å—Ç–∞—Ç—É—Å–∞</option>
                <option value="with-status">–¢–æ–ª—å–∫–æ —Å–æ —Å—Ç–∞—Ç—É—Å–∞–º–∏</option>
                <option value="–Ω–∞–ø–∏—Å–∞—Ç—å">üìù –ù–∞–¥–æ –Ω–∞–ø–∏—Å–∞—Ç—å</option>
                <option value="–Ω–∞–ø–∏—Å–∞–ª">‚úâÔ∏è –ù–∞–ø–∏—Å–∞–ª</option>
                <option value="–æ—Ç–≤–µ—Ç–∏–ª–∏">üí¨ –û—Ç–≤–µ—Ç–∏–ª–∏</option>
                <option value="–¥–æ–≥–æ–≤–æ—Ä–∏–ª–∏—Å—å">ü§ù –î–æ–≥–æ–≤–æ—Ä–∏–ª–∏—Å—å</option>
                <option value="—Å–∫–∏–Ω—É—Ç—å_–ø–æ—Å—Ç">üì§ –°–∫–∏–Ω—É—Ç—å –ø–æ—Å—Ç</option>
                <option value="–ø–æ—Å—Ç_—Å–∫–∏–Ω—É–ª">üì® –ü–æ—Å—Ç —Å–∫–∏–Ω—É–ª</option>
                <option value="–∂–¥–µ—Ç_–æ–ø–ª–∞—Ç—É">üí≥ –ñ–¥—ë—Ç –æ–ø–ª–∞—Ç—É</option>
                <option value="–∂–¥–µ–º_–ø—É–±–ª–∏–∫–∞—Ü–∏—é">‚è≥ –ñ–¥—ë–º –ø—É–±–ª–∏–∫–∞—Ü–∏—é</option>
                <option value="–æ–ø–ª–∞—á–µ–Ω–æ">üí∞ –û–ø–ª–∞—á–µ–Ω–æ</option>
                <option value="–æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ">‚úÖ –û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ</option>
                <option value="–æ—Ç–∫–∞–∑">‚ùå –û—Ç–∫–∞–∑</option>
                <option value="–º–æ—Ä–æ–∑">ü•∂ –ú–æ—Ä–æ–∑</option>
                <option value="–Ω–µ_—Ä–∞–±–æ—á–∏–π">üö´ –ö–æ–Ω—Ç–∞–∫—Ç –Ω–µ —Ä–∞–±–æ—á–∏–π</option>
                <option value="–æ—Ç–º–µ–Ω–∞">‚õî –û—Ç–º–µ–Ω–∞</option>
            </select>
            
            <label style="margin-left: 15px;">–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞:</label>
            <select id="sort-by" onchange="applyFilters()">
                <option value="id">–ü–æ –Ω–æ–º–µ—Ä—É</option>
                <option value="status">–ü–æ —Å—Ç–∞—Ç—É—Å—É</option>
                <option value="checked">–°–Ω–∞—á–∞–ª–∞ –Ω–µ–ø—Ä–æ–π–¥–µ–Ω–Ω—ã–µ</option>
                <option value="checked-reverse">–°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–π–¥–µ–Ω–Ω—ã–µ</option>
            </select>
        </div>
    </div>
    
    <div class="controls">
        <button class="btn-open" onclick="openNext5()">üöÄ –û—Ç–∫—Ä—ã—Ç—å 5 –Ω–µ–ø—Ä–æ–π–¥–µ–Ω–Ω—ã—Ö</button>
        <button class="btn-toggle" onclick="toggleAll()">üìÇ –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –≤—Å—ë</button>
        <button class="btn-sync" onclick="syncNow()">üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å</button>
        <button class="btn-save" onclick="exportProgress()">üíæ –°–∫–∞—á–∞—Ç—å</button>
        <button class="btn-import" onclick="document.getElementById('importFile').click()">üìÇ –ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
        <button class="btn-reset" onclick="resetAll()">üîÑ –°–±—Ä–æ—Å–∏—Ç—å</button>
        <input type="file" id="importFile" accept=".json" style="display:none" onchange="importProgress(event)">
    </div>
    
    <div class="controls">
        <button style="background: #22c55e; color: #000;" onclick="checkAllVisible()">‚òëÔ∏è –û—Ç–º–µ—Ç–∏—Ç—å –≤—Å–µ –≤–∏–¥–∏–º—ã–µ</button>
        <button style="background: #f59e0b; color: #000;" onclick="uncheckAllVisible()">‚òê –°–Ω—è—Ç—å –≤—Å–µ –≤–∏–¥–∏–º—ã–µ</button>
    </div>

    <div id="contacts-list"></div>
    
    <button class="btn-add" onclick="addNewContact()">‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –∫–∞—Ä—Ç–æ—á–∫—É</button>

    <script>
        // JSONBin.io –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
        const JSONBIN_BIN_ID = '6959bde543b1c97be91779ad';
        const JSONBIN_API_KEY = '$2a$10$Q4vUhcjpPv1qAUP/QF5yVO7.tk1ltIqMHCzkeSrvUXcA9CGm00XL.';
        
        let contactsData = [
            { id: "1", name: "Aff_lab –∫—Ä–µ–∞—Ç–∏–≤—ã", link: "https://t.me/aff_adsmanager" },
            { id: "2", name: "Kos_creos", link: "https://t.me/Kos170796" },
            { id: "3", name: "–£–Ω–∏–∫–∞–ª–∏–∑–∞—Ç–æ—Ä", link: "https://t.me/helpunik" },
            { id: "4", name: "–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –≤–∞–π—Ç–æ–≤", link: "https://t.me/traff_land" },
            { id: "5", name: "–ì–ª–∞–∑ —Ü—É–∫–µ—Ä–∞", link: "https://t.me/moon_right" },
            { id: "6", name: "Devils chat", link: "https://t.me/Anastasia_Devils_SMM" },
            { id: "7", name: "Rocket_traffic", link: "https://t.me/Rocket_main" },
            { id: "8", name: "–ö–∞–Ω–∞–ª —É—Å–∞—Ç–æ–≥–æ", link: "https://t.me/mustage_ads" },
            { id: "9", name: "–ñ–µ–ª—Ç—ã–π –≤–µ–±", link: "https://t.me/babbie_valerie" },
            { id: "10", name: "Cloaking House", link: "https://t.me/Denis_Cloaking_House" },
            { id: "11", name: "Hey, moneymaker!", link: "https://t.me/heymnads" },
            { id: "12", name: "CPA Hunter - –≤–∞–∫–∞–Ω—Å–∏–∏", link: "https://t.me/teftelkaaa" },
            { id: "13", name: "FB-killa", link: "https://t.me/ads_fbkillla" },
            { id: "14", name: "Partnerkin", link: "https://t.me/v_partnerkin" },
            { id: "15", name: "HR - CPA/–ê—Ä–±–∏—Ç—Ä–∞–∂", link: "https://t.me/annaa_Aff" },
            { id: "16", name: "Adamant", link: "https://t.me/greensuittt" },
            { id: "17", name: "SEO –∫–∞–Ω–∞–ª –®–∞–∫–∏–Ω–∞", link: "https://t.me/mikeshakin" },
            { id: "18", name: "AQ TRAFF", link: "https://t.me/AQOWNER" },
            { id: "19", name: "–ë–ª–æ–≥ –ê–¥–∞–º–∞", link: "https://t.me/adam_fb" },
            { id: "20", name: "–í–õ–ê–î–ò–ú–ò–† –ê–†–ë–ò–¢–†–ê–ñ", link: "https://t.me/vladimir_card" },
            { id: "21", name: "CPAGRAM", link: "https://t.me/akhloponin" },
            { id: "22", name: "SEO HR", link: "https://t.me/pilot_bbk" },
            { id: "23", name: "–¢–æ–ø IT –í–∞–∫–∞–Ω—Å–∏–∏", link: "https://t.me/arturpanteleev" },
            { id: "24", name: "HR IT (web-hh.com)", link: "https://t.me/Na_ACG" },
            { id: "25", name: "GetIT jobs", link: "https://t.me/GETIT_AGENCY" },
            { id: "26", name: "Lenkep", link: "https://t.me/vasilisa_lev" },
            { id: "27", name: "JETLAG CHAT", link: "https://t.me/jetlagadmin" },
            { id: "28", name: "–ú–ò–† –ö–†–ï–ê–¢–û–†–û–í", link: "https://t.me/polinagorbenko" },
            { id: "29", name: "–ö–†–ï–ê–¢–û–†–´", link: "https://t.me/nikitastaritsky" },
            { id: "30", name: "—á–∞—Ç–∏–∫ –≤–∞–∫–∞–Ω—Å–∏–π", link: "https://t.me/heynessfe" },
            { id: "31", name: "EventHunter", link: "https://t.me/rueventjob_bot" },
            { id: "32", name: "–í–∞–∫–∞–Ω—Å–∏–∏ SMM –∏ Digital", link: "https://t.me/denominant" },
            { id: "33", name: "Influencer Marketing", link: "https://t.me/chamiarouskaya" },
            { id: "34", name: "Digital –≤–∞–∫–∞–Ω—Å–∏–∏", link: "https://t.me/mLccrew" },
            { id: "35", name: "SMM —Ä–∞–±–æ—Ç–∞", link: "https://t.me/ViktorShipilov" },
            { id: "36", name: "PR-—Ä–∞–±–æ—Ç–∞", link: "https://t.me/pr_job_bot" },
            { id: "37", name: "Job for Marketing", link: "https://t.me/forallmarketing" },
            { id: "38", name: "marketing jobs", link: "https://t.me/ma_riux" },
            { id: "39", name: "–ö–æ–ø–∏—Ä–∞–π—Ç–µ—Ä –†–µ–¥–∞–∫—Ç–æ—Ä", link: "https://t.me/call_saulz" },
            { id: "40", name: "Work for writers", link: "https://t.me/Nastya_Teresh" },
            { id: "41", name: "designer_jobs", link: "https://t.me/designer_jobs" },
            { id: "42", name: "(–Ω–µ —É–∫–∞–∑–∞–Ω–æ)", link: "https://t.me/+t0FXfu2dPWQwMGEy" },
            { id: "43", name: "uxui_jobs", link: "https://t.me/uxui_jobs" },
            { id: "44", name: "design_jobs_uxui", link: "https://t.me/irademidovna" },
            { id: "45", name: "CPA HUNTER", link: "https://t.me/hr_affiliate" },
            { id: "46", name: "LENKEP HR", link: "https://t.me/Arbitrazh_vakansii_rabota" },
            { id: "47", name: "IGW", link: "https://t.me/igwtel" },
            { id: "48", name: "tilttok", link: "https://t.me/belfort228" },
            { id: "49", name: "mrbeast_tiktok_bot", link: "https://t.me/ilham_mazi" },
            { id: "50", name: "rwbrr", link: "https://t.me/rawberrry" },
            { id: "51", name: "TraffUnique", link: "https://t.me/purrari_cash" },
            { id: "52", name: "ttgetcode_bot", link: "https://t.me/Chivap_Disco" },
            { id: "53", name: "FastDomainBot", link: "https://t.me/nightcyb" },
            { id: "54", name: "infatuta", link: "https://t.me/yablukko" },
            { id: "55", name: "tiktokillerchat", link: "https://t.me/privetgus" },
            { id: "56", name: "TtMailChek_Bot", link: "https://t.me/vktoi" },
            { id: "57", name: "k1ndstore_bot", link: "https://t.me/k1ndlzt" },
            { id: "58", name: "BOOMtheStorebot", link: "https://t.me/boomsups" },
            { id: "59", name: "ttwavestore_bot", link: "https://t.me/Loperold" },
            { id: "60", name: "mutedshopbot", link: "https://t.me/emptyenemy" },
            { id: "61", name: "TikTok_Proliv", link: "https://t.me/tt_proliv_supportt" },
            { id: "62", name: "MysticShorts", link: "https://t.me/metahub_support" },
            { id: "63", name: "iSkill", link: "https://t.me/iSkill" },
            { id: "64", name: "shoteamstore_bot", link: "https://t.me/shoteam_manager" },
            { id: "65", name: "fbfuckbook", link: "https://t.me/diaspads" },
            { id: "66", name: "how_team", link: "https://t.me/mssster" },
            { id: "67", name: "NCKAPI_bot", link: "https://t.me/Rq666" },
            { id: "68", name: "Rassvet (–ó–µ–ª–µ–Ω–∫–∞)", link: "https://t.me/lolzlive" },
            { id: "69", name: "Casherino", link: "https://t.me/casherino" },
            { id: "70", name: "TraFFeeQ_Chat", link: "https://t.me/MaximTakahuli" },
            { id: "71", name: "–£—Å–∞—Ç—ã–π + –ì—Ä–æ–º —à–æ–ø", link: "https://t.me/ubt_igorgofman" },
            { id: "72", name: "MagicStore", link: "https://t.me/netzahualcoyoti" },
            { id: "73", name: "VideoGena", link: "https://t.me/VideoGena_sup" },
            { id: "74", name: "SEOLookBot + GmCheckBot", link: "https://t.me/how_oo" },
            { id: "75", name: "METAonStorebot", link: "https://t.me/avtozaliv" },
            { id: "76", name: "MotiShopBot", link: "https://t.me/MotiMake" },
            { id: "77", name: "Bulletproof", link: "https://t.me/apple_rab" },
            { id: "78", name: "Midas Hosting", link: "https://t.me/midas_hostingg" },
            { id: "79", name: "–ü–∞—Ä—Ç–Ω–µ—Ä–∫–∏–Ω", link: "https://t.me/Natali_Melnichenko" },
            { id: "80", name: "Mad_Cpa", link: "https://t.me/Mad_Cpa" },
            { id: "81", name: "AffCommunity", link: "https://t.me/affcommunity_marketing" },
            { id: "82", name: "CPA Words", link: "https://t.me/cpawords" }
        ];

        const statusLabels = {
            '': '‚Äî',
            '–Ω–∞–ø–∏—Å–∞—Ç—å': 'üìù –ù–∞–¥–æ –Ω–∞–ø–∏—Å–∞—Ç—å',
            '–Ω–∞–ø–∏—Å–∞–ª': '‚úâÔ∏è –ù–∞–ø–∏—Å–∞–ª',
            '–æ—Ç–≤–µ—Ç–∏–ª–∏': 'üí¨ –û—Ç–≤–µ—Ç–∏–ª–∏',
            '–¥–æ–≥–æ–≤–æ—Ä–∏–ª–∏—Å—å': 'ü§ù –î–æ–≥–æ–≤–æ—Ä–∏–ª–∏—Å—å',
            '—Å–∫–∏–Ω—É—Ç—å_–ø–æ—Å—Ç': 'üì§ –°–∫–∏–Ω—É—Ç—å –ø–æ—Å—Ç',
            '–ø–æ—Å—Ç_—Å–∫–∏–Ω—É–ª': 'üì® –ü–æ—Å—Ç —Å–∫–∏–Ω—É–ª',
            '–∂–¥–µ—Ç_–æ–ø–ª–∞—Ç—É': 'üí≥ –ñ–¥—ë—Ç –æ–ø–ª–∞—Ç—É',
            '–∂–¥–µ–º_–ø—É–±–ª–∏–∫–∞—Ü–∏—é': '‚è≥ –ñ–¥—ë–º –ø—É–±–ª–∏–∫–∞—Ü–∏—é',
            '–æ–ø–ª–∞—á–µ–Ω–æ': 'üí∞ –û–ø–ª–∞—á–µ–Ω–æ',
            '–æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ': '‚úÖ –û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ',
            '–æ—Ç–∫–∞–∑': '‚ùå –û—Ç–∫–∞–∑',
            '–º–æ—Ä–æ–∑': 'ü•∂ –ú–æ—Ä–æ–∑',
            '–Ω–µ_—Ä–∞–±–æ—á–∏–π': 'üö´ –ù–µ —Ä–∞–±–æ—á–∏–π',
            '–æ—Ç–º–µ–Ω–∞': '‚õî –û—Ç–º–µ–Ω–∞'
        };

        const statusOrder = ['–Ω–∞–ø–∏—Å–∞—Ç—å', '–Ω–∞–ø–∏—Å–∞–ª', '–æ—Ç–≤–µ—Ç–∏–ª–∏', '–¥–æ–≥–æ–≤–æ—Ä–∏–ª–∏—Å—å', '—Å–∫–∏–Ω—É—Ç—å_–ø–æ—Å—Ç', '–ø–æ—Å—Ç_—Å–∫–∏–Ω—É–ª', '–∂–¥–µ—Ç_–æ–ø–ª–∞—Ç—É', '–∂–¥–µ–º_–ø—É–±–ª–∏–∫–∞—Ü–∏—é', '–æ–ø–ª–∞—á–µ–Ω–æ', '–æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ', '–æ—Ç–∫–∞–∑', '–º–æ—Ä–æ–∑', '–Ω–µ_—Ä–∞–±–æ—á–∏–π', '–æ—Ç–º–µ–Ω–∞', ''];

        let progressData = {};
        let allExpanded = false;
        let syncTimeout = null;
        let isSyncing = false;

        // ========== –°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–Ø ==========
        
        function setSyncStatus(status, message) {
            const el = document.getElementById('sync-status');
            el.className = 'sync-status ' + status;
            el.textContent = message;
        }
        
        async function loadFromCloud() {
            setSyncStatus('syncing', '‚è≥ –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ –æ–±–ª–∞–∫–∞...');
            try {
                const response = await fetch('https://api.jsonbin.io/v3/b/' + JSONBIN_BIN_ID + '/latest', {
                    headers: {
                        'X-Master-Key': JSONBIN_API_KEY
                    }
                });
                
                if (!response.ok) throw new Error('HTTP ' + response.status);
                
                const result = await response.json();
                const data = result.record;
                
                if (data && data.contacts) {
                    progressData = data.contacts;
                }
                if (data && data.customContacts && Array.isArray(data.customContacts)) {
                    data.customContacts.forEach(c => {
                        if (!contactsData.find(existing => existing.id === c.id)) {
                            contactsData.push(c);
                        }
                    });
                }
                if (data && data.contactsOrder && Array.isArray(data.contactsOrder)) {
                    applyContactsOrder(data.contactsOrder);
                }
                
                setSyncStatus('synced', '‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ');
                return true;
            } catch (err) {
                console.error('Load from cloud error:', err);
                setSyncStatus('error', '‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ' + err.message);
                return false;
            }
        }
        
        async function saveToCloud() {
            if (isSyncing) return;
            isSyncing = true;
            
            setSyncStatus('syncing', '‚è≥ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...');
            
            const customContacts = contactsData.filter(c => c.isCustom);
            const contactsOrder = contactsData.map(c => c.id);
            
            const data = {
                date: new Date().toISOString(),
                version: 3,
                contacts: progressData,
                customContacts: customContacts,
                contactsOrder: contactsOrder
            };
            
            try {
                const response = await fetch('https://api.jsonbin.io/v3/b/' + JSONBIN_BIN_ID, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Master-Key': JSONBIN_API_KEY
                    },
                    body: JSON.stringify(data)
                });
                
                if (!response.ok) throw new Error('HTTP ' + response.status);
                
                setSyncStatus('synced', '‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ ' + new Date().toLocaleTimeString());
            } catch (err) {
                console.error('Save to cloud error:', err);
                setSyncStatus('error', '‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è');
            }
            
            isSyncing = false;
        }
        
        function scheduleSaveToCloud() {
            if (syncTimeout) clearTimeout(syncTimeout);
            syncTimeout = setTimeout(saveToCloud, 1000);
        }
        
        function syncNow() {
            loadFromCloud().then(() => {
                applyFilters();
                updateStats();
            });
        }

        // ========== –û–°–ù–û–í–ù–´–ï –§–£–ù–ö–¶–ò–ò ==========
        
        function escapeHtml(text) {
            if (!text) return '';
            return text.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;').replace(/'/g, '&#039;');
        }

        function renderContacts(filteredData = null) {
            const container = document.getElementById('contacts-list');
            container.innerHTML = '';
            
            const dataToRender = filteredData || contactsData;
            let shownCount = 0;
            
            dataToRender.forEach((c, index) => {
                const data = progressData[c.id] || {};
                const isChecked = data.checked || false;
                const statusText = statusLabels[data.status || ''] || '‚Äî';
                const displayName = escapeHtml(data.customName || c.name);
                const displayLink = escapeHtml(data.customLink || c.link);
                shownCount++;
                
                const isFirst = index === 0;
                const isLast = index === dataToRender.length - 1;
                
                let deleteBtn = '<button class="btn-delete" onclick="event.stopPropagation(); deleteContact(\'' + c.id + '\')">‚úï</button>';
                
                const html = 
                    '<div class="contact ' + (isChecked ? 'done' : '') + '" data-id="' + c.id + '">' +
                        '<div class="contact-header" onclick="toggleExpand(\'' + c.id + '\', event)">' +
                            '<div class="move-buttons">' +
                                '<button class="btn-move" ' + (isFirst ? 'disabled style="opacity:0.3"' : '') + ' onclick="event.stopPropagation(); moveContact(\'' + c.id + '\', -1)" title="–í–≤–µ—Ä—Ö">‚ñ≤</button>' +
                                '<button class="btn-move" ' + (isLast ? 'disabled style="opacity:0.3"' : '') + ' onclick="event.stopPropagation(); moveContact(\'' + c.id + '\', 1)" title="–í–Ω–∏–∑">‚ñº</button>' +
                            '</div>' +
                            '<input type="checkbox" class="checkbox" ' + (isChecked ? 'checked' : '') + ' onclick="event.stopPropagation()" onchange="toggleCheck(\'' + c.id + '\')">' +
                            '<span class="number">' + (index + 1) + '</span>' +
                            '<input type="text" class="contact-name-input" value="' + displayName + '" onclick="event.stopPropagation()" onchange="updateField(\'' + c.id + '\', \'customName\', this.value)">' +
                            '<span class="contact-status">' + statusText + '</span>' +
                            '<button class="btn-open-single" onclick="event.stopPropagation(); openContact(\'' + c.id + '\')">–û—Ç–∫—Ä—ã—Ç—å</button>' +
                            deleteBtn +
                            '<span class="expand-icon">‚ñº</span>' +
                        '</div>' +
                        '<div class="contact-fields">' +
                            '<div class="field">' +
                                '<label>–°—Ç–∞—Ç—É—Å</label>' +
                                '<select onchange="updateField(\'' + c.id + '\', \'status\', this.value)">' +
                                    '<option value=""' + (!data.status ? ' selected' : '') + '>‚Äî</option>' +
                                    '<option value="–Ω–∞–ø–∏—Å–∞—Ç—å"' + (data.status === '–Ω–∞–ø–∏—Å–∞—Ç—å' ? ' selected' : '') + '>üìù –ù–∞–¥–æ –Ω–∞–ø–∏—Å–∞—Ç—å</option>' +
                                    '<option value="–Ω–∞–ø–∏—Å–∞–ª"' + (data.status === '–Ω–∞–ø–∏—Å–∞–ª' ? ' selected' : '') + '>‚úâÔ∏è –ù–∞–ø–∏—Å–∞–ª</option>' +
                                    '<option value="–æ—Ç–≤–µ—Ç–∏–ª–∏"' + (data.status === '–æ—Ç–≤–µ—Ç–∏–ª–∏' ? ' selected' : '') + '>üí¨ –û—Ç–≤–µ—Ç–∏–ª–∏</option>' +
                                    '<option value="–¥–æ–≥–æ–≤–æ—Ä–∏–ª–∏—Å—å"' + (data.status === '–¥–æ–≥–æ–≤–æ—Ä–∏–ª–∏—Å—å' ? ' selected' : '') + '>ü§ù –î–æ–≥–æ–≤–æ—Ä–∏–ª–∏—Å—å</option>' +
                                    '<option value="—Å–∫–∏–Ω—É—Ç—å_–ø–æ—Å—Ç"' + (data.status === '—Å–∫–∏–Ω—É—Ç—å_–ø–æ—Å—Ç' ? ' selected' : '') + '>üì§ –°–∫–∏–Ω—É—Ç—å –ø–æ—Å—Ç</option>' +
                                    '<option value="–ø–æ—Å—Ç_—Å–∫–∏–Ω—É–ª"' + (data.status === '–ø–æ—Å—Ç_—Å–∫–∏–Ω—É–ª' ? ' selected' : '') + '>üì® –ü–æ—Å—Ç —Å–∫–∏–Ω—É–ª</option>' +
                                    '<option value="–∂–¥–µ—Ç_–æ–ø–ª–∞—Ç—É"' + (data.status === '–∂–¥–µ—Ç_–æ–ø–ª–∞—Ç—É' ? ' selected' : '') + '>üí≥ –ñ–¥—ë—Ç –æ–ø–ª–∞—Ç—É</option>' +
                                    '<option value="–∂–¥–µ–º_–ø—É–±–ª–∏–∫–∞—Ü–∏—é"' + (data.status === '–∂–¥–µ–º_–ø—É–±–ª–∏–∫–∞—Ü–∏—é' ? ' selected' : '') + '>‚è≥ –ñ–¥—ë–º –ø—É–±–ª–∏–∫–∞—Ü–∏—é</option>' +
                                    '<option value="–æ–ø–ª–∞—á–µ–Ω–æ"' + (data.status === '–æ–ø–ª–∞—á–µ–Ω–æ' ? ' selected' : '') + '>üí∞ –û–ø–ª–∞—á–µ–Ω–æ</option>' +
                                    '<option value="–æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ"' + (data.status === '–æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ' ? ' selected' : '') + '>‚úÖ –û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ</option>' +
                                    '<option value="–æ—Ç–∫–∞–∑"' + (data.status === '–æ—Ç–∫–∞–∑' ? ' selected' : '') + '>‚ùå –û—Ç–∫–∞–∑</option>' +
                                    '<option value="–º–æ—Ä–æ–∑"' + (data.status === '–º–æ—Ä–æ–∑' ? ' selected' : '') + '>ü•∂ –ú–æ—Ä–æ–∑</option>' +
                                    '<option value="–Ω–µ_—Ä–∞–±–æ—á–∏–π"' + (data.status === '–Ω–µ_—Ä–∞–±–æ—á–∏–π' ? ' selected' : '') + '>üö´ –ö–æ–Ω—Ç–∞–∫—Ç –Ω–µ —Ä–∞–±–æ—á–∏–π</option>' +
                                    '<option value="–æ—Ç–º–µ–Ω–∞"' + (data.status === '–æ—Ç–º–µ–Ω–∞' ? ' selected' : '') + '>‚õî –û—Ç–º–µ–Ω–∞</option>' +
                                '</select>' +
                            '</div>' +
                            '<div class="field">' +
                                '<label>–¶–µ–Ω–∞</label>' +
                                '<input type="text" placeholder="–Ω–∞–ø—Ä. $100 –∏–ª–∏ 5000‚ÇΩ" value="' + escapeHtml(data.price || '') + '" onchange="updateField(\'' + c.id + '\', \'price\', this.value)">' +
                            '</div>' +
                            '<div class="field">' +
                                '<label>–ê–∫—Ç—É–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–∞–∫—Ç</label>' +
                                '<input type="text" placeholder="@username" value="' + escapeHtml(data.actualContact || '') + '" onchange="updateField(\'' + c.id + '\', \'actualContact\', this.value)">' +
                            '</div>' +
                            '<div class="field">' +
                                '<label>–í—Å–µ –∫–æ–Ω—Ç–∞–∫—Ç—ã</label>' +
                                '<input type="text" placeholder="@user1, @user2..." value="' + escapeHtml(data.allContacts || '') + '" onchange="updateField(\'' + c.id + '\', \'allContacts\', this.value)">' +
                            '</div>' +
                            '<div class="field">' +
                                '<label>–ó–∞–º–µ—Ç–∫–∏</label>' +
                                '<input type="text" placeholder="–ª—é–±—ã–µ –∑–∞–º–µ—Ç–∫–∏..." value="' + escapeHtml(data.notes || '') + '" onchange="updateField(\'' + c.id + '\', \'notes\', this.value)">' +
                            '</div>' +
                            '<div class="field full-width">' +
                                '<label>–°—Å—ã–ª–∫–∞ –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–û—Ç–∫—Ä—ã—Ç—å"</label>' +
                                '<input type="text" placeholder="https://t.me/username" value="' + displayLink + '" onchange="updateField(\'' + c.id + '\', \'customLink\', this.value)">' +
                            '</div>' +
                            '<div class="field full-width">' +
                                '<label>–ü–ª–æ—â–∞–¥–∫–∏</label>' +
                                '<textarea placeholder="–∫–∞–Ω–∞–ª—ã, –±–æ—Ç—ã, —á–∞—Ç—ã..." onchange="updateField(\'' + c.id + '\', \'platforms\', this.value)">' + escapeHtml(data.platforms || '') + '</textarea>' +
                            '</div>' +
                        '</div>' +
                    '</div>';
                container.innerHTML += html;
            });
            
            document.getElementById('shown-count').textContent = shownCount;
        }

        function applyFilters() {
            const filterStatus = document.getElementById('filter-status').value;
            const sortBy = document.getElementById('sort-by').value;
            const searchInput = document.getElementById('search-input');
            const searchQuery = searchInput ? searchInput.value.toLowerCase().trim() : '';
            
            let filtered = [...contactsData];
            
            if (searchQuery) {
                filtered = filtered.filter(c => {
                    const data = progressData[c.id] || {};
                    const searchFields = [
                        c.id,
                        c.name,
                        c.link,
                        data.customName || '',
                        data.customLink || '',
                        data.status || '',
                        data.price || '',
                        data.actualContact || '',
                        data.allContacts || '',
                        data.notes || '',
                        data.platforms || ''
                    ].join(' ').toLowerCase();
                    
                    return searchFields.includes(searchQuery);
                });
            }
            
            if (filterStatus === 'no-status') {
                filtered = filtered.filter(c => !progressData[c.id]?.status);
            } else if (filterStatus === 'with-status') {
                filtered = filtered.filter(c => progressData[c.id]?.status);
            } else if (filterStatus) {
                filtered = filtered.filter(c => progressData[c.id]?.status === filterStatus);
            }
            
            if (sortBy === 'status') {
                filtered.sort((a, b) => {
                    const statusA = progressData[a.id]?.status || '';
                    const statusB = progressData[b.id]?.status || '';
                    return statusOrder.indexOf(statusA) - statusOrder.indexOf(statusB);
                });
            } else if (sortBy === 'checked') {
                filtered.sort((a, b) => {
                    const checkedA = progressData[a.id]?.checked ? 1 : 0;
                    const checkedB = progressData[b.id]?.checked ? 1 : 0;
                    return checkedA - checkedB;
                });
            } else if (sortBy === 'checked-reverse') {
                filtered.sort((a, b) => {
                    const checkedA = progressData[a.id]?.checked ? 1 : 0;
                    const checkedB = progressData[b.id]?.checked ? 1 : 0;
                    return checkedB - checkedA;
                });
            }
            
            window.currentFilteredIds = filtered.map(c => c.id);
            
            renderContacts(filtered);
        }

        function toggleExpand(id, event) {
            if (event.target.classList.contains('checkbox') || 
                event.target.classList.contains('btn-open-single') ||
                event.target.classList.contains('btn-delete') ||
                event.target.classList.contains('btn-move') ||
                event.target.classList.contains('contact-name-input')) {
                return;
            }
            const contact = document.querySelector('.contact[data-id="' + id + '"]');
            contact.classList.toggle('expanded');
        }

        function toggleAll() {
            allExpanded = !allExpanded;
            const contacts = document.querySelectorAll('.contact');
            const btn = document.querySelector('.btn-toggle');
            
            contacts.forEach(contact => {
                if (allExpanded) {
                    contact.classList.add('expanded');
                } else {
                    contact.classList.remove('expanded');
                }
            });
            
            btn.textContent = allExpanded ? 'üìÅ –°–≤–µ—Ä–Ω—É—Ç—å –≤—Å—ë' : 'üìÇ –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –≤—Å—ë';
        }

        function toggleCheck(id) {
            if (!progressData[id]) progressData[id] = {};
            progressData[id].checked = !progressData[id].checked;
            
            const contact = document.querySelector('.contact[data-id="' + id + '"]');
            if (progressData[id].checked) {
                contact.classList.add('done');
            } else {
                contact.classList.remove('done');
            }
            
            updateStats();
            scheduleSaveToCloud();
        }

        function updateField(id, field, value) {
            if (!progressData[id]) progressData[id] = {};
            progressData[id][field] = value;
            
            if (field === 'status') {
                const contact = document.querySelector('.contact[data-id="' + id + '"]');
                const statusSpan = contact.querySelector('.contact-status');
                statusSpan.textContent = statusLabels[value] || '‚Äî';
            }
            
            scheduleSaveToCloud();
        }

        function openContact(id) {
            const contact = contactsData.find(c => c.id === id);
            const data = progressData[id] || {};
            const link = data.customLink || contact?.link || '';
            if (link) {
                window.open(link, '_blank');
            } else {
                alert('–°—Å—ã–ª–∫–∞ –Ω–µ —É–∫–∞–∑–∞–Ω–∞. –†–∞–∑–≤–µ—Ä–Ω–∏—Ç–µ –∫–∞—Ä—Ç–æ—á–∫—É –∏ –¥–æ–±–∞–≤—å—Ç–µ —Å—Å—ã–ª–∫—É.');
            }
        }

        function addNewContact() {
            let maxId = 0;
            contactsData.forEach(c => {
                const num = parseInt(c.id);
                if (num > maxId) maxId = num;
            });
            Object.keys(progressData).forEach(id => {
                const num = parseInt(id);
                if (num > maxId) maxId = num;
            });
            
            const newId = String(maxId + 1);
            
            contactsData.push({
                id: newId,
                name: "–ù–æ–≤—ã–π –∫–æ–Ω—Ç–∞–∫—Ç",
                link: "",
                isCustom: true
            });
            
            progressData[newId] = {
                checked: false,
                status: "–Ω–∞–ø–∏—Å–∞—Ç—å",
                customName: "–ù–æ–≤—ã–π –∫–æ–Ω—Ç–∞–∫—Ç",
                isCustom: true
            };
            
            scheduleSaveToCloud();
            applyFilters();
            updateStats();
            
            setTimeout(() => {
                const newContact = document.querySelector('.contact[data-id="' + newId + '"]');
                if (newContact) {
                    newContact.scrollIntoView({ behavior: 'smooth' });
                    newContact.classList.add('expanded');
                }
            }, 100);
        }

        function deleteContact(id) {
            if (!confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç—É –∫–∞—Ä—Ç–æ—á–∫—É?')) return;
            
            const index = contactsData.findIndex(c => c.id === id);
            if (index > -1) {
                contactsData.splice(index, 1);
            }
            
            delete progressData[id];
            
            scheduleSaveToCloud();
            applyFilters();
            updateStats();
        }
        
        function applyContactsOrder(order) {
            contactsData.sort((a, b) => {
                const indexA = order.indexOf(a.id);
                const indexB = order.indexOf(b.id);
                if (indexA === -1) return 1;
                if (indexB === -1) return -1;
                return indexA - indexB;
            });
        }

        function exportProgress() {
            const customContacts = contactsData.filter(c => c.isCustom);
            const contactsOrder = contactsData.map(c => c.id);
            
            const data = {
                date: new Date().toISOString(),
                version: 3,
                contacts: progressData,
                customContacts: customContacts,
                contactsOrder: contactsOrder
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'progress_' + new Date().toISOString().slice(0,10) + '.json';
            a.click();
            URL.revokeObjectURL(url);
        }

        function importProgress(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    
                    if (data.checked && Array.isArray(data.checked)) {
                        progressData = {};
                        data.checked.forEach(id => {
                            progressData[id] = { checked: true };
                        });
                    } else if (data.contacts) {
                        progressData = data.contacts;
                    }
                    
                    if (data.customContacts && Array.isArray(data.customContacts)) {
                        data.customContacts.forEach(c => {
                            if (!contactsData.find(existing => existing.id === c.id)) {
                                contactsData.push(c);
                            }
                        });
                    }
                    
                    if (data.contactsOrder && Array.isArray(data.contactsOrder)) {
                        applyContactsOrder(data.contactsOrder);
                    }
                    
                    scheduleSaveToCloud();
                    applyFilters();
                    updateStats();
                    
                    const doneCount = Object.values(progressData).filter(c => c && c.checked).length;
                    alert('‚úÖ –ü—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–≥—Ä—É–∂–µ–Ω! –ì–æ—Ç–æ–≤–æ: ' + doneCount);
                } catch (err) {
                    alert('‚ùå –û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞: ' + err.message);
                }
            };
            reader.readAsText(file);
            event.target.value = '';
        }

        function resetAll() {
            if (confirm('–¢–æ—á–Ω–æ —Å–±—Ä–æ—Å–∏—Ç—å –≤–µ—Å—å –ø—Ä–æ–≥—Ä–µ—Å—Å? –í—Å–µ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã!')) {
                progressData = {};
                contactsData = contactsData.filter(c => !c.isCustom);
                scheduleSaveToCloud();
                applyFilters();
                updateStats();
            }
        }

        function updateStats() {
            const total = contactsData.length;
            const done = Object.values(progressData).filter(c => c && c.checked).length;
            
            document.getElementById('done-count').textContent = done;
            document.getElementById('total-count').textContent = total;
            document.getElementById('progress-bar').style.width = (done / total * 100) + '%';
        }

        function openNext5() {
            const uncheckedIds = contactsData
                .filter(c => !progressData[c.id]?.checked)
                .slice(0, 5);
            
            uncheckedIds.forEach(c => {
                const data = progressData[c.id] || {};
                const link = data.customLink || c.link;
                if (link) window.open(link, '_blank');
            });
        }
        
        function checkAllVisible() {
            const ids = window.currentFilteredIds || contactsData.map(c => c.id);
            if (!confirm('–û—Ç–º–µ—Ç–∏—Ç—å –≤—Å–µ ' + ids.length + ' –≤–∏–¥–∏–º—ã—Ö –∫–∞—Ä—Ç–æ—á–µ–∫ –∫–∞–∫ –ø—Ä–æ–π–¥–µ–Ω–Ω—ã–µ?')) return;
            
            ids.forEach(id => {
                if (!progressData[id]) progressData[id] = {};
                progressData[id].checked = true;
            });
            
            scheduleSaveToCloud();
            applyFilters();
            updateStats();
        }
        
        function uncheckAllVisible() {
            const ids = window.currentFilteredIds || contactsData.map(c => c.id);
            if (!confirm('–°–Ω—è—Ç—å –≥–∞–ª–æ—á–∫–∏ —Å–æ –≤—Å–µ—Ö ' + ids.length + ' –≤–∏–¥–∏–º—ã—Ö –∫–∞—Ä—Ç–æ—á–µ–∫?')) return;
            
            ids.forEach(id => {
                if (progressData[id]) {
                    progressData[id].checked = false;
                }
            });
            
            scheduleSaveToCloud();
            applyFilters();
            updateStats();
        }

        // –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–µ–∫
        function moveContact(id, direction) {
            const index = contactsData.findIndex(c => c.id === id);
            if (index === -1) return;
            
            const newIndex = index + direction;
            if (newIndex < 0 || newIndex >= contactsData.length) return;
            
            const temp = contactsData[index];
            contactsData[index] = contactsData[newIndex];
            contactsData[newIndex] = temp;
            
            scheduleSaveToCloud();
            applyFilters();
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        loadFromCloud().then(() => {
            applyFilters();
            updateStats();
        });
    </script>
</body>
</html>
